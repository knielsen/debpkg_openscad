#!/usr/bin/make -f

# export DH_VERBOSE=1

# this hardcoded stuff is, to quote bug#571640, crap. unfortunately,
# the solution suggested there (conflicting with qmake-qt3) does not
# work here as this package indirectly build-depends on it via
# libcgal-dev
QMAKEARGS=-makefile -nocache "QMAKE_CFLAGS_RELEASE=-g -O2" "QMAKE_CFLAGS_DEBUG=-g -O2" "QMAKE_CXXFLAGS_RELEASE=-g -O2" "QMAKE_CXXFLAGS_DEBUG=-g -O2" QMAKE_STRIP=: PREFIX=/usr

%:
	dh $@

override_dh_auto_configure:
	qmake-qt4 ${QMAKEARGS}

override_dh_auto_build:
	dh_auto_build
	convert icons/icon-alpha.png -resize 688x688 -background transparent -gravity center -extent 688x688 openscad.png

override_dh_auto_install:
	dh_auto_install
	ln -s /usr/share/openscad/examples debian/openscad/usr/share/doc/openscad/examples

override_dh_clean:
	dh_clean
	rm -f openscad.png
